# Курсовой проект (2 курс 3 семестр)

[![Build Status](https://travis-ci.com/Evgengrmit/course-project.svg?branch=master)](https://travis-ci.com/Evgengrmit/course-project)

## Интеллектуальное программное обеспечение для решения задач информационной безопасности

Применение машинного обучения в задаче обнаружения сетевых атак (DDoS-атак).

### Содержание

* Описание курсового проекта
* Список задач
* Теоретическая часть
* Полезные ссылки
* TODO-лист

### Описание курсового проекта

Исследовать возможности применения машинного обучения для решения задачи обнаружения аномального сетевого трафика (
DDoS-атака). Рассмотреть следующие методы машинного обучения: градиентный бустинг, нейронные сети. Разработать
программу, использующую обученную модель машинного обучения и определяющую по сгенерированным данным наличие атаки.
Создать подпрограмму, генерирующую аномальный и нормальный трафик. Сравнить различные методы машинного обучения и
сделать выводы о дальнейшем использовании данного метода в области информационной безопасности.

### Список задач

1. Изучить материалы, посвященные DDoS-атакам
2. Ознакомиться с принципами машинного обучения
3. Рассмотреть методы машинного обучения:
    * Градиентный бустинг (**LightGBM**, **CatBoost**)
    * Нейронные сети (**Keras**)
4. Изучить библиотеку для манипулирования сетевыми пакетами **Scapy**
5. Разработать утилиту для генерации аномального и нормального трафика
6. Отобрать данные для обучения моделей машинного обучения и провести их предварительную обработку
7. Обучить модели
8. Сравнить их работоспособность на сгенерированных данных и сделать выводы

### Теоретическая часть

1. [DDOS-атаки](https://github.com/Evgengrmit/course-project/blob/master/theory/DoS_%26_DDoS.md)
2. [Нейронные сети](https://github.com/Evgengrmit/course-project/blob/master/theory/artificial_neural_networks.md)
3. [Градиентный бустинг](https://github.com/Evgengrmit/course-project/blob/master/theory/boosting.md)

### Описание работы

Ознакомиться с алгоритмами работы программ и их результатами Вы можете по ссылке:

[Презентация](https://slides.com/evgengrmit/course)

Были обучены модели. Также проведено их тестирование и кросс-валидация. Класс, описывающий генератор был протестирован.
Тесты добавлены в continuous integration.

### Примеры графического интерфейса

#### GUI для генератора

![b_n_c](theory/images/Main%20README%20images/gen.png)

#### GUI для детектора

![b_n_c](theory/images/Main%20README%20images/det.png)

### Схема работы приложений

![b_n_c](theory/images/Main%20README%20images/scheme.png)

### Вывод

В данной работе были рассмотрен вариант реализации связки “Generator - Detector”. Сгенерированные данные
преобразовывались в данные для детектора. В дальнейшем предполагается усовершенствование модели и добавление возможности
исследовать входящий трафик для данного хоста. Кроме того, отметим еще раз, что использование градиентного бустинга
оказалось эффективнее. В дальнейшем предлагается использовать данный метод, так как он может работать с данными без
масштабирования и с пропусками в признаках, в то время как нейросеть очень требовательна к этим условиям. Ввиду того,
что преступники находят новые способы для незаметного проведения атак, предлагается периодически обучать модели на новых
данных. Более того, наиболее эффективным будет комбинирование машинного обучения и пороговых методов обнаружения.
Реализация генератора поддерживает генерацию трафика с произвольной целью, разным числом ботов и выбор протокола.
Детектор реализует 3 модели машинного обучения и выбор исследуемого лога. Точность предсказаний и скорость генерации в
рамках данной работы являются оптимальными. Отметим, что данное исследование является одной из задач информационной
безопасности, в которых может применяться машинное обучения. Сфера применения искусственного интеллекта в ИБ намного
шире.

### Заключение

В рамках данного курсового проекта:

1. Рассмотрены материалы, посвященные следующим темам:

* DDoS-атаки;
* Машинное обучение;
* Применение методов машинного обучения для задачи детектирования DDoS-атак.

2. Изучены библиотеки языка Python, необходимые для разработки приложений:

* Для машинного обучения: Keras, CatBoost, LightGBM;
* Для манипулирования сетевыми пакетами: Scapy.

3. Проведены исследования исходных данных:

* Отобраны признаки, характеризующие пакеты
* Получена информация, необходимая для генерации пакетов.

4. Обучены модели машинного обучения:

* Проведены тесты на зависимость качества от задаваемых параметров;
* Подобраны оптимальные параметры;
* Реализованы тестирование и кросс-валидация;

5. Написаны следующие программы с графическим интерфейсом (GUI):

* Generator – реализует генерацию аномального и нормального трафика и сбор информации о них;
* Detector – при помощи моделей машинного обучения предсказывает является ли пакет частью атаки и сообщает пользователю
  свои оценки.

6. Получены и проанализированы результаты работы приложений:

* Проведены тесты, проверяющие работу генератора;
* Сделаны выводы о дальнейшем применении данного метода для решения задачи защиты компьютеров и серверов от атак типа
  распределенный отказ в обслуживании.

В результате выполнения курсового проекта были получены навыки работы с сетевыми пакетами, получены начальные сведения о
машинном обучении, разработан прототип программного продукта для решения прикладной задачи. Также были применены знания,
умения и навыки, полученные при изучении дисциплины «Технологии и методы программирования».

Таким образом, учитывая сложность DDoS-атак в настоящее время, можно сделать вывод о том, что традиционные пороговые
методы обнаружения уже не являются эффективными и надежными. Достижения в области искусственного интеллекта (ИИ) в
последние годы привели к применению моделей машинного обучения для повышения эффективности обнаружения DDoS-атак. Только
благодаря использованию методов прогнозирования, основанных на глубоком обучении, для анализа больших объемов данных о
трафике можно быстро выявить и устранить вредоносные схемы атак. Кроме того, важно отметить, что модели машинного
обучения очень хорошо справляются с классификационными и прогностическими задачами, если данные статистически схожи с их
моделями обучения. Но как только они сталкиваются с новыми ситуациями, которые отличаются от того, что они узнали ранее,
они могут вести себя неожиданным образом. Хотя использование машинного обучения для борьбы с экспоненциальной угрозой
DDoS-атак быстро становится все более интересной областью, оно все еще требует определенной степени человеческой
адаптации, но общие результаты действительно очень многообещающие.

### Полезные ссылки

* [Keras](https://keras.io)
* [Scapy](https://scapy.net)
* [CatBoost](https://catboost.ai)
* [LightGBM](https://lightgbm.readthedocs.io/en/latest/)
* [DDoS Dataset](https://www.kaggle.com/devendra416/ddos-datasets)
* [WillKoehrsen/feature-selector](https://github.com/WillKoehrsen/feature-selector)
* [SHAP (SHapley Additive exPlanations)](https://github.com/slundberg/shap)
* [Открытый курс машинного обучения](https://habr.com/ru/company/ods/blog/322626/)
* [Why we can't use IP as feature?](https://www.researchgate.net/publication/309467794_A_study_on_efficient_detection_of_network-based_IP_spoofing_DDoS_and_malware-infected_Systems)

## TODO-лист

1. [x] Изучить материалы, посвященные DDoS-атакам
2. [x] Ознакомиться с принципами машинного обучения
3. [x] Рассмотреть методы машинного обучения
4. [x] Отобрать данные для обучения моделей машинного обучения и провести их предварительную обработку
5. [x] Изучить инструменты для работы с сетевым трафиком
6. [x] Разработать утилиту для генерации аномального и нормального трафика
7. [x] Обучить модели
8. [x] Проверить работоспособность моделей в реальных условиях при помощи сгенерированного трафика
9. [x] Сравнить результаты, сделать выводы
